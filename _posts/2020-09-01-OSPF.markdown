---
layout: post
title:  "Protocolo OSPF - Formação de Vizinhança"
date:   2020-09-01 22:03:36 +0530
categories: OSPF Redes Cisco Linux
---

---
O protocolo OSPF (*Open Shortest Path First*) é um protocolo de roteamento de redes e foi desenvolvimento pelo IETF (Enginnering Task Force), trabalha diretamente sobre o IP com protocolo número 89. É um protocolo aberto sendo suportado pela maioria dos fabricantes e também por sistemas operacionais Linux, BSD's e Unix e usa o algoritmo de Dijkstra para determinar o melhor caminho para cada rede.

---

O OSPF ou Open Shortest Path First é um protocolo de roteamento que utiliza padrão aberto, classless, com convergência rápida e usa o custo como uma métrica.

Os domínios de roteamento do OSPF são divididos em áreas, essa divisão traz alguns benefícios:

* Minizar o número de entradas na tabela de roteamento;
* Minizar a inundação de LSA's a uma área específica;
* Minimizar o impacto de mudanças de topologia, uma vez que um link fica Down o SPF irá rodar novamente o algoritmo naquela área a qual pertence;
* Reforçar o conceito de um projeto de rede.

<img src="https://raw.githubusercontent.com/keilon-araujo/posts/master/OSPF-1.jpg" alt="area-0" style="zoom:80%;" />



O cabeçalho do OSPF, traz algumas informaçoes como a versão sendo v2 para IPv4 e v3 para IPv6, o campo `Type` identifica o tipo de pacote a ser transportado que no total são 5, além de `Router ID` e `Area ID` e Autenticação caso seja configurado.



```
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   Version     |     Type      |         Packet length         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                          Router ID                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           Area ID                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           Checksum            |             AuType            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       Authentication                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       Authentication                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```



Os cindo pacotes transpostados pelo OSPF são:

| Tipo | Pacote               | Função                                                       |
| ---- | -------------------- | ------------------------------------------------------------ |
| 1    | Hello                | Descoberta/Manutenção de vizinhança                          |
| 2    | Database Description | é um resumo do LSDB (banco de dados link-state), incluindo o Router ID e o número de squencia de cada LSA no LSDB |
| 3    | Link State Request   | Solicita o LSU do vizinho                                    |
| 4    | Link State Update    | Contém entrada LSA completa, incluindo informações de topologia por exemplo, o Router ID do roteador local eo RID e custo de cada vizinho. |
| 5    | Link State Ack       | usado para reconhecer o recebimento dos outros pacotes, exceto o hello e o próprio LSAck |



Os roteadores rodando o OSPF possuem três tabelas para administração do protocolo de roteamento, são elas:

- **Adjacency Database (Neighbor Table)**: Guarda as informações das vizinhanças descobertas pelo OSPF através do protocolo `Hello`.
- **Link-State Database (Topology Table)**: Guarda a base de dados topológica do OSPF, ou seja, os LSA's que foram recebidas pelo roteador e serão utilizadas pelo SPF para descobrir as melhores rotas.
- **Fowarding Database (Routing Table)**: As melhores rotas serão inseridas na tabela de roteamento.

